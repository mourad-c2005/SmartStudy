<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SmartStudy+ | Sujet</title>

  <!-- Fonts & Bootstrap -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root{--green:#4CAF50;--light:#E8F5E8;--white:#fff;--yellow:#FFEB3B}
    body{font-family:'Open Sans',sans-serif;background:var(--light);margin:0;color:#333}
    .top-nav{background:var(--white);padding:1rem 5%;box-shadow:0 4px 15px rgba(76,175,80,0.1);display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:1000}
    .logo{font-family:'Montserrat',sans-serif;font-weight:700;font-size:1.8rem;color:var(--green);text-decoration:none}
    .container-main{padding:3rem 5%}
    .thread-card{background:var(--white);padding:1.2rem;border-radius:12px;border-left:5px solid var(--green);box-shadow:0 6px 18px rgba(0,0,0,0.04)}
    .reply-card{background:#fcfffc;border-radius:10px;padding:0.9rem;margin-top:0.8rem;border:1px solid #e9f7ef}
    .meta{font-size:0.85rem;color:#666}
    .reply-form textarea{min-height:120px}
    footer{background:#222;color:#ccc;text-align:center;padding:2rem 0;margin-top:2rem}
  </style>
</head>
<body>

  <!-- Nav -->
  <nav class="top-nav">
    <a class="logo" href="index.html">SmartStudy+</a>
    <div class="nav-menu">
      <a href="forums.html" class="active">Forum</a>
      <a href="mesplans.html">Mes Plans</a>
      <a href="progres.html">Progrès</a>
    </div>
    <div class="user-section d-flex align-items-center gap-2">
      <div class="user-info text-end"><div class="name fw-bold">CHEBIL Fedi</div><div class="role small text-muted">Étudiant</div></div>
      <img src="https://via.placeholder.com/45?text=F" class="rounded-circle border border-3 border-success" alt="photo">
    </div>
  </nav>

  <main class="container-main">
    <div id="threadArea" class="thread-card">
      <!-- thread content filled by JS -->
    </div>

    <section style="margin-top:1.2rem">
      <h5>Réponses</h5>
      <div id="repliesList" style="margin-top:0.6rem"></div>
    </section>

    <section style="margin-top:1.2rem">
      <h5>Ajouter une réponse</h5>
      <form id="replyForm" class="reply-form">
        <div class="mb-3">
          <textarea name="content" class="form-control" placeholder="Écrire votre réponse..." required></textarea>
        </div>
        <div>
          <button class="btn" style="background:var(--green);color:#fff">Publier la réponse</button>
        </div>
      </form>
    </section>
  </main>

  <footer>
    <p>SmartStudy+ © 2025 — Nature • Croissance • Sérénité</p>
    <p>Développé par <strong>BLUEPIXEL 2032</strong></p>
  </footer>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Demo data (replace with fetch from backend using ID param)
    const demoThread = {
      id: 1,
      title: 'Comment planifier mes révisions ?',
      author: 'Ayoub',
      category: 'Planning',
      created: '2025-10-20',
      content: 'Bonjour, j’aimerais savoir comment organiser mes sessions pour maximiser la rétention avant les examens. Merci !'
    };
    const demoReplies = [
      { id:1, author:'Mourad', date:'2025-10-21', content:'Salut — commence par diviser le plan en sessions de 25min (technique Pomodoro)...' },
      { id:2, author:'Prof. Lina', date:'2025-10-22', content:'N oublie pas de prioriser selon les pondérations des examens et de revoir régulièrement.' }
    ];

    function renderThread(t){
      const area = document.getElementById('threadArea');
      area.innerHTML = `
        <h3 style="font-family:Montserrat;color:var(--green)">${t.title}</h3>
        <div class="meta">Par <strong>${t.author}</strong> • ${t.category} • ${t.created}</div>
        <hr/>
        <p style="margin-top:0.8rem">${t.content}</p>
        <div class="d-flex gap-2" style="margin-top:0.6rem">
          <button class="btn btn-sm" id="btnLike"><i class="fas fa-thumbs-up"></i> J'aime</button>
          <button class="btn btn-sm btn-outline-secondary" id="btnReport">Signaler</button>
        </div>
      `;
    }

    function renderReplies(list){
      const container = document.getElementById('repliesList');
      container.innerHTML = '';
      list.forEach(r => {
        const div = document.createElement('div');
        div.className = 'reply-card';
        div.innerHTML = `
          <div class="d-flex justify-content-between">
            <div><strong>${r.author}</strong> <span class="small-muted">• ${r.date}</span></div>
            <div class="small-muted">#${r.id}</div>
          </div>
          <p style="margin-top:0.5rem">${r.content}</p>
        `;
        container.appendChild(div);
      });
      if(list.length === 0) container.innerHTML = `<p class="small-muted">Aucune réponse pour l'instant. Soyez le premier à répondre !</p>`;
    }

    // initial render
    renderThread(demoThread);
    renderReplies(demoReplies);

    // Reply form
    document.getElementById('replyForm').addEventListener('submit', function(e){
      e.preventDefault();
      const fd = new FormData(this);
      const newReply = {
        id: demoReplies.length + 1,
        author: 'Vous',
        date: new Date().toISOString().split('T')[0],
        content: fd.get('content')
      };
      // TODO: POST /api/threads/:id/replies
      demoReplies.push(newReply);
      renderReplies(demoReplies);
      this.reset();
    });

    // If connecting with backend:
    // - Read thread id from URL: const params = new URLSearchParams(location.search); const id = params.get('id');
    // - GET /api/threads/:id -> thread + replies
    // - POST /api/threads/:id/replies -> add reply
  </script>
</body>
</html>
