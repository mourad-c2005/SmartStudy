<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SmartStudy+ | Forum</title>

  <!-- Fonts & Bootstrap -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root{
      --green:#4CAF50; --yellow:#FFEB3B; --light:#E8F5E8; --white:#fff; --dark:#2e7d32;
    }
    body{font-family:'Open Sans',sans-serif;background:var(--light);margin:0;color:#333}
    .top-nav{background:var(--white);padding:1rem 5%;box-shadow:0 4px 15px rgba(76,175,80,0.1);display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:1000}
    .logo{font-family:'Montserrat',sans-serif;font-weight:700;font-size:1.8rem;color:var(--green);text-decoration:none}
    .nav-menu{display:flex;gap:1.2rem}
    .nav-menu a{color:#555;text-decoration:none;font-weight:600;padding:0.4rem 0.9rem;border-radius:30px}
    .nav-menu a.active,.nav-menu a:hover{background:var(--light);color:var(--green)}
    .container-main{padding:3rem 5%}
    .forum-actions{display:flex;gap:1rem;flex-wrap:wrap;align-items:center;margin-bottom:1rem}
    .search-box{flex:1;min-width:220px}
    .badge-cat{background:#f0f7f0;color:var(--green);padding:0.25rem 0.5rem;border-radius:12px;font-weight:600}
    .topic-card{background:var(--white);border-radius:12px;padding:1rem;border-left:4px solid var(--green);box-shadow:0 6px 18px rgba(0,0,0,0.04);margin-bottom:1rem}
    .topic-meta{font-size:0.85rem;color:#666}
    .small-muted{font-size:0.85rem;color:#777}
    footer{background:#222;color:#ccc;text-align:center;padding:2rem 0;margin-top:2rem}
    footer strong{color:var(--yellow)}
  </style>
</head>
<body>

  <!-- Nav -->
  <nav class="top-nav">
    <a class="logo" href="index.html">SmartStudy+</a>
    <div class="nav-menu">
      <a href="index.html">Accueil</a>
      <a href="mesplans.html">Mes Plans</a>
      <a href="planning.html">Planning</a>
      <a href="groupes.html">Groupes</a>
      <a href="progres.html">Progrès</a>
      <a href="forums.html" class="active">Forum</a>
    </div>
    <div class="user-section d-flex align-items-center gap-2">
      <div class="user-info text-end">
        <div class="name fw-bold">CHEBIL Fedi</div>
        <div class="role text-muted small">Étudiant</div>
      </div>
      <img src="https://via.placeholder.com/45?text=F" class="rounded-circle border border-3 border-success" alt="photo">
    </div>
  </nav>

  <!-- Main -->
  <main class="container-main">
    <h1 style="font-family:Montserrat;color:var(--green);text-align:center;margin-bottom:1.5rem">Forum & Discussions</h1>

    <div class="forum-actions">
      <input id="searchInput" class="form-control search-box" type="search" placeholder="Chercher un sujet, mot-clé..." />
      <select id="categoryFilter" class="form-select" style="width:220px">
        <option value="">Toutes catégories</option>
        <option value="Planning">Planning</option>
        <option value="Méthodes">Méthodes</option>
        <option value="Technique">Technique</option>
        <option value="Général">Général</option>
      </select>
      <button id="btnNewTopic" class="btn" style="background:var(--green);color:#fff;border-radius:30px">
        <i class="fas fa-plus"></i> Nouveau sujet
      </button>
    </div>

    <!-- Topics List -->
    <div id="topicsList">
      <!-- example topic (will be filled by JS) -->
    </div>
  </main>

  <!-- New Topic Modal -->
  <div class="modal fade" id="newTopicModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <form id="newTopicForm" class="p-3">
          <div class="modal-header">
            <h5 class="modal-title">Créer un nouveau sujet</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Titre</label>
              <input name="title" required class="form-control" placeholder="Ex: Comment organiser mes sessions de révision ?" />
            </div>
            <div class="mb-3">
              <label class="form-label">Catégorie</label>
              <select name="category" class="form-select">
                <option>Planning</option>
                <option>Méthodes</option>
                <option>Technique</option>
                <option>Général</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Contenu</label>
              <textarea name="content" rows="6" class="form-control" placeholder="Décrivez votre question..."></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
            <button type="submit" class="btn" style="background:var(--green);color:#fff">Publier</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <p>SmartStudy+ © 2025 — Nature • Croissance • Sérénité</p>
    <p>Développé par <strong>BLUEPIXEL 2032</strong></p>
  </footer>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Sample data (replace with API calls)
    const topics = [
      { id:1, title:'Comment planifier mes révisions ?', category:'Planning', author:'Ayoub', replies:12, last:'2025-10-20', excerpt:'Je cherche une méthode pour organiser mes révisions avant les examens...' },
      { id:2, title:'Flashcards vs Fiches papier', category:'Méthodes', author:'Mourad', replies:5, last:'2025-10-22', excerpt:'Quels outils pour retenir + efficacement ?' },
      { id:3, title:'Erreur d’installation de l’environnement C', category:'Technique', author:'Fedi', replies:3, last:'2025-10-25', excerpt:'J’ai un problème avec GCC sous Windows...' }
    ];

    const topicsList = document.getElementById('topicsList');
    const searchInput = document.getElementById('searchInput');
    const categoryFilter = document.getElementById('categoryFilter');
    const newTopicModal = new bootstrap.Modal(document.getElementById('newTopicModal'));
    const newTopicForm = document.getElementById('newTopicForm');

    function renderTopics(list){
      topicsList.innerHTML = '';
      if(list.length === 0){
        topicsList.innerHTML = `<div class="topic-card text-center"><p class="small-muted">Aucun sujet trouvé.</p></div>`;
        return;
      }
      list.forEach(t => {
        const div = document.createElement('div');
        div.className = 'topic-card d-flex justify-content-between align-items-start';
        div.innerHTML = `
          <div style="flex:1">
            <a href="thread.html?id=${t.id}" class="h5" style="text-decoration:none;color:#2c3e50">${t.title}</a>
            <div class="topic-meta small-muted mt-1">${t.excerpt}</div>
            <div class="small-muted mt-2">Par <strong>${t.author}</strong> • <span class="badge-cat">${t.category}</span></div>
          </div>
          <div style="width:120px;text-align:right">
            <div class="small-muted">${t.replies} réponses</div>
            <div class="small-muted">Dernier: ${t.last}</div>
          </div>
        `;
        topicsList.appendChild(div);
      });
    }

    // initial render
    renderTopics(topics);

    // Search & filter
    function applyFilter(){
      const q = searchInput.value.toLowerCase();
      const cat = categoryFilter.value;
      const filtered = topics.filter(t => {
        const matchQ = t.title.toLowerCase().includes(q) || t.excerpt.toLowerCase().includes(q) || t.author.toLowerCase().includes(q);
        const matchCat = !cat || t.category === cat;
        return matchQ && matchCat;
      });
      renderTopics(filtered);
    }
    searchInput.addEventListener('input', applyFilter);
    categoryFilter.addEventListener('change', applyFilter);

    // New topic
    document.getElementById('btnNewTopic').addEventListener('click', ()=> newTopicModal.show());
    newTopicForm.addEventListener('submit', function(e){
      e.preventDefault();
      const fd = new FormData(this);
      const newTopic = {
        id: Date.now(),
        title: fd.get('title'),
        category: fd.get('category'),
        author: 'Vous',
        replies: 0,
        last: new Date().toISOString().split('T')[0],
        excerpt: fd.get('content').slice(0,120)
      };
      // TODO: replace by POST /api/forums
      topics.unshift(newTopic);
      renderTopics(topics);
      newTopicModal.hide();
      this.reset();
      // Optionally redirect to new thread page
      // location.href = `thread.html?id=${newTopic.id}`;
    });

    // If you integrate with backend:
    // - GET /api/forums -> topics array
    // - POST /api/forums -> create new topic
  </script>
</body>
</html>
